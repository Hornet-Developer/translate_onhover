<template id="transover-popup-template">
  <style>
    #tat_input_container {
      display: flex;
      margin-bottom: 3px;
    }

    #tat_input {
      -webkit-box-sizing: border-box;
      margin-bottom: 5px;
      margin-right: 5px;
      margin-left: 5px;
      flex-grow: 2;
    }

    #tat_submit_container {
      text-align: right;
      margin-right: 5px;
    }

    #tat_submit {
      width: 45px;
      margin-left: 5px;
    }

    #tat_to_lang {
      width: 150px;
    }

    #tat_popup {
      min-width: 415px;
    }

    .pos_translation {
      padding-bottom: 4px;
    }

    .rtl {
      direction: rtl;
    }

    #swap_languages {
      vertical-align: middle;
    }

    main {
      color: #333;
      font-family: Arial, sans-serif;
      font-size: 16px;
      font-weight: 300;
      line-height: 19px;

      background: #fcf7d9;
      text-align: left;
      border-style: solid;
      border-width: 1px;
      border-color: #ccc;
      box-shadow: rgba(0,0,0,0.2) 0px 2px 5px;
      border-radius: 5px;
      padding: 7px 9px 3px 9px;
      position: fixed;
      z-index: 2147483647;
      top: -1500px;
      left: 0;
      box-sizing: content-box;
    }
  </style>

  <main></main>
</template>

<script>
var owner = document.currentScript.ownerDocument;

var TransoverPopupProto = Object.create(HTMLElement.prototype);

TransoverPopupProto.createdCallback = function() {
  var t = owner.querySelector('#transover-popup-template').content.cloneNode(true);
  this.createShadowRoot().appendChild(t);
};

TransoverPopupProto.attributeChangedCallback = function(attribute, oldVal, newVal) {
  var main = this.shadowRoot.querySelector('main');

  if (attribute == "content") {
    main.innerHTML = newVal;

    setTimeout(function() {
        var main = this.shadowRoot.querySelector('main');
        var style = window.getComputedStyle(main);

        this.setAttribute('content-width', parseFloat(style.width));
        this.setAttribute('content-height', parseFloat(style.height));

        this.setAttribute('outer-width', main.offsetWidth);
        this.setAttribute('outer-height', main.offsetHeight);

        var e = new CustomEvent("transover-popup_content_updated");
        this.dispatchEvent(e);
    }.bind(this), 0);

  } else if (attribute == "top") {
    main.style.top = newVal + 'px';
  } else if (attribute == "left") {
    main.style.left = newVal + 'px';
  } else if (attribute == "width") {
    main.style.width = newVal + 'px';
  } else if (attribute == "height") {
    main.style.height = newVal + 'px';
  }
};

document.registerElement('transover-popup', { prototype: TransoverPopupProto });
</script>
